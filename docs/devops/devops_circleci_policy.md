---
title: 【IT技術の知見】設計ポリシー＠CircleCI
description: 設計ポリシー＠CircleCIの知見を記録しています。
---

# 設計ポリシー＠CircleCI

## はじめに

本サイトにつきまして、以下をご認識のほど宜しくお願いいたします。

> ℹ️ 参考：https://hiroki-it.github.io/tech-notebook-mkdocs/

<br>

## 01. CIツールに関する脆弱性対策

### CIツールに関する脆弱性対策とは

対象のソースコードの脆弱性ではなく、CIツールに関するそれに対処する。

<br>

### 認証/認可

#### ▼ CIツールを操作できる開発者に関する認証/認可

CIツールを操作できる開発者を認証し、また認可スコープを付与する。利便的かつ安全な認証/認可方法を選ぶ。

| 認証/認可方法 | 二要素認証 | 推奨/非推奨 |
|---------------|------------|-----------|
| Basic認証     | -          | 非推奨      |
| OAuth         | あり         | 推奨        |
|               | なし         | 非推奨      |
| OIDC          | あり         | 推奨        |
|               | なし         | 非推奨      |
| SAML          | あり         | 推奨        |
|               | なし         | 非推奨      |

#### ▼ CIツール自体の認証/認可

CIツールを認証し、また認可スコープを付与する。

| 期限   | 説明                                              | 方法                                                                                                                                                                             | 推奨/非推奨 |
|------|-------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
| 恒久的 | CIツールを恒久的に認証し、また同様に認可スコープを恒久的に付与する。 | ・AWSの場合、ツールにIAMユーザを紐付けておき、このIAMユーザーに常にIAMロールを紐づけておく。<br> ・GCPの場合、ツールにIAMユーザを紐付けておき、このIAMユーザーに常にロールを紐づけておく。                                                           | 非推奨      |
| 一時的 | CIツールを一時的に認証し、また同様に認可スコープを一時的に付与する。 | ・AWSの場合、ツールにIAMユーザー/SAMLユーザー/OIDCユーザーを紐付けておき、AWS STSで一時的に認証する。また、AssumeRoleで認可スコープを一時的に付与する。<br>・GCPの場合、ツールにIAMユーザーを紐づけておき、条件付きロールバインディングで認可スコープを付与する。 | 推奨        |

<br>

### 機密な変数やファイルの管理

たとえ、CIツールから機密な変数が漏洩しても、復号化しにくいようにする。CircleCIの実行環境に出力する変数やファイルは、```base64```形式や暗号化キーであらかじめエンコードしておき、使用時にデコードまたは復号化する。

<br>

## 02. 事後処理

### 通知

CIパイプラインとCDパイプライン上で実行しているステップ（例：ホワイトボックステスト、デプロイ、など）の結果が通知されるようにする。通知があることと品質を高めることは直接的には関係ないが、開発者の作業効率が上がるため、間接的に品質を高めることにつながる。

<br>



