# DB設計のドキュメント

## DB全体

記入中...

<br>

## DBテーブル

このドキュメントはDBテーブルの設計を考えるためのドキュメントであり、生成AIに読み込ませることを想定している。

1. 検証対象の実装を読み込む。
2. 次のDBテーブルのプラクティスを読み込む。
3. 次の観点でDBテーブルを追加／改善する。

- カラム
  - ドメイン上意味付けする必要があるものをカラムにできているか
  - ドメイン上意味付けする必要がないもの（単なる集計結果や複合データ）をカラムにしていないか
- リレーション
  - リレーションが重複しており、過剰でないか
- 複合プライマリーの定義では、次を考慮する
  - バッチ処理では重複防止のために複合プライマリーを使用する
- 複合インデックスの定義では、以下を考慮する
  - SQLで`=`の等価指定のあるカラムを前におき、次に`IN`句で複数の等価指定、最後に`BETWEEN`で範囲指定のあるカラムを後に置く。
  - カーディナリティが低いほど、B-Treeインデックスの検索グループが増えるためDBが処理しないといけないレコード数が増えてしまう。そこで、等価条件が複数ある場合、カーディナリティの高いカラムをより前におく。
