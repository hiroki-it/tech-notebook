---
title: 【知見を記録するサイト】Go＠コードベースのテスト
description: Go＠コードベースのテストの知見をまとめました．
---

# Go＠コードベースのテスト

## はじめに

本サイトにつきまして，以下をご認識のほど宜しくお願いいたします．

参考：https://hiroki-it.github.io/tech-notebook-mkdocs/about.html

<br>

## 01. ユニットテスト

### テストの単位

構造体をテストスイートとし，ユニットテストを定義する．

<br>

### ブラックボックステスト

#### ▼ 実現方法

テストファイルのパッケージ名が，同じディレクトリ配下にある実際の処理ファイルに『```_test```』を加えたパッケージ名の場合，それはブラックボックステストになる．ちなみに，Goでは1つのディレクトリ内に1つのパッケージ名しか宣言できないが，ブラックボックステストのために『```_test```』を加えることは許されている．

<br>

### ホワイトボックステスト

#### ▼ 実現方法

テストファイルのパッケージ名が，同じディレクトリ配下にある実際の処理ファイルのパッケージ名と同じ場合，それはホワイトボックステストになる．

#### ▼ 網羅率

網羅率はパッケージを単位として解析される．網羅については，以下のリンクを参考にせよ．

参考：https://hiroki-it.github.io/tech-notebook-mkdocs/software/software_application_testing_based_on_code_php.html

<br>

### テストの実装方法のTips

#### ▼ インターフェースの導入

テストできない構造体はモックに差し替えられることなる．この時，あらかじめ実際の構造体をインターフェースの実装にしておく．テスト時に，モックもインターフェイスの実装とすれば，モックが実際の構造体と同じデータ型として認識されるようになる．これにより，モックに差し替えられるようになる．

#### ▼ テーブル駆動テスト

参考：https://github.com/golang/go/wiki/TableDrivenTests

#### ▼ 回帰テスト

回帰テストを実現するため，過去のテスト結果をテストデータを保存しておき，今回のテスト結果が過去のものと一致するかを確認する．Goでは，このテストデータをファイルを『Golden File』という．Golden（金）は化学的に安定した物質であることに由来しており，『安定したプロダクト』とかけている．回帰テストについては，以下のリンクを参考にせよ．

参考：https://hiroki-it.github.io/tech-notebook-mkdocs/software/software_application_testing_based_on_code_php.html

#### ▼ POSTデータの切り分け

POSTリクエストを受信するテストを行う時に，JSONデータをファイルに切り分けておく．これを```ReadFile```関数で読み出すようにする．

**＊実装例＊**

```go
package test

import (
	"io/ioutil"
)

/**
 * mainメソッドをテストします．
 */
func TestMain(t *testing.T) {
	// jsonファイルの読み出し
	data, err := ioutil.ReadFile("../testdata/foo.json")

	// 以下にテストコードを実装していく
}
```

<br>