---
title: 【IT技術の知見】サービスメッシュ採用に関わる比較＠サービスメッシュ
description: サービスメッシュ採用に関わる比較＠サービスメッシュの知見を記録しています。
---

# 比較＠サービスメッシュ

## はじめに

本サイトにつきまして、以下をご認識のほど宜しくお願いいたします。

> ↪️ 参考：https://hiroki-it.github.io/tech-notebook/

<br>

## 01. サービスメッシュ採用に関わる比較

サービスメッシュを採用しない場合 (Kubernetes のみ) と比較して、各サービスメッシュのツールがインフラ領域のどんな責務を実装してくれるかを記載する。

もしサービスメッシュを採用しない場合、サービスメッシュと同じ責務をアプリ領域に実装する必要がある。

> ↪️ 参考：
>
> - https://www.amazon.co.jp/dp/1492043788
> - https://servicemesh.es/
> - https://hiroki-it.github.io/tech-notebook/infrastructure_as_code/infrastructure_as_code_kubernetes_custom_resource_istio.html

<br>

## 02. トラフィック管理

### プロトコル

| 能力 (執筆時点2023/03/11) | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| TCP                       |         Service + kube-proxy          |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| HTTP/1.2                  |         Service + kube-proxy          |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| HTTP/2.0                  |         Service + kube-proxy          |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| gRPC                      |         Service + kube-proxy          |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |

<br>

### ネットワーク

Kubernetesでは、Serviceが同じバージョンのPodとしか通信できず、もし異なるバージョンを対象にしたい場合、異なるServiceを作成する必要がある。

一方で、サービスメッシュツールは異なるバージョンのPodに、さまざまな手法 (例：カナリア方式、トラフィックミラーリング方式、など) で通信できる。

| 能力 (執筆時点2023/03/11)                           | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| --------------------------------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| サービスディスカバリー                              |         Service + kube-proxy          |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| ロードバランシング                                  |         Service + kube-proxy (`L4`)         |  ⭕️ (`L4`、`L7`)  |   ⭕️   |  ⭕️   |     ⭕️      |
| ルーティング (ホストベース、パスベース、割合ベース) |         Service + kube-proxy          |  ⭕️  |    ×    |   ×    |      ×       |
| CNIアドオン                                         |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |

<br>

## 03. 回復

| 能力 (執筆時点2023/03/11)         | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| --------------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| サーキットブレイカー              |               記入中...               |  ⭕️  |    ×    |  ⭕️   |     ⭕️      |
| フォールトインジェクション        |               記入中...               |  ⭕️  |   ⭕️   |   ×    |      ×       |
| 再試行処理                        |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| タイムアウト                      |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| リクエスト数制限 (レートリミット) |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |

<br>

## 04. 認証/認可

| 能力 (執筆時点2023/03/11) | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| ポリシーベースのACL       |               記入中...               |  ⭕️  |    ×    |   ×    |      ×       |
| 意図ベースのACL           |               記入中...               |   ×   |    ×    |  ⭕️   |      ×       |

<br>

## 05. 通信データの暗号化

Kubernetesでは、Podの作成に応じて証明書のKubernetesリソース (Certificate、CertificateSigningRequest、など) を作成する必要がある。

| 能力 (執筆時点2023/03/11) | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| SSL証明書のローテーション |              CertManager              |  ⭕️  |    ×    |  ⭕️   |     ⭕️      |
| 相互TLS                   |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| Spiffeに対応              |               記入中...               |  ⭕️  |    ×    |  ⭕️   |      ×       |

<br>

## 06. テレメトリー管理

### ログの場合

サービスメッシュツールを使用する場合、マイクロサービスの代わりに、サイドカープロキシがアクセスログを作成/送信する。

ただし、マイクロサービスでもアクセスログを作成しても良い。

| 能力 (執筆時点2023/03/11)            | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------------------ | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| マイクロサービスの実行ログの収集 | - | × | × | × | × |
| マイクロサービスのアクセスログの収集 | Fluentd、FluentBit | ⭕️ | ⭕️ | ⭕️ | ⭕️ |

<br>

### メトリクスの場合

サービスメッシュツールを使用する場合、マイクロサービスの代わりに、サイドカープロキシがメトリクスを作成/送信する。

| 能力 (執筆時点2023/03/11)                          |             Kubernetes (サービスメッシュ採用せず)             | Istio | Linkerd | Consul | AWS App Mesh |
| -------------------------------------------------- | :-----------------------------------------------------------: | :---: | :-----: | :----: | :----------: |
| マイクロサービスのゴールデンシグナルの収集 | クライアントパッケージ (例：OTelクライアントパッケージ、など) | ⭕️ | ⭕️ | ⭕️ | ⭕️ |
| マイクロサービスのエンドポイント別のフィルタリング | クライアントパッケージ (例：OTelクライアントパッケージ、など) | ⭕️ | ⭕️ | ⭕️ | × |

<br>

### 分散トレースの場合

サービスメッシュツールを使用する場合、マイクロサービスの代わりに、分散トレースがメトリクスを作成/送信する。

ただし、マイクロサービス間でのトレースIDの伝播はマイクロサービスに実装する必要がある。

| 能力 (執筆時点2023/03/11)                                                    |             Kubernetes (サービスメッシュ採用せず)             | Istio | Linkerd | Consul | AWS App Mesh |
| ---------------------------------------------------------------------------- | :-----------------------------------------------------------: | :---: | :-----: | :----: | :----------: |
| 分散トレース収集ツール (例：Otelコレクター、jaegerコレクター、など) への送信 | クライアントパッケージ (例：OTelクライアントパッケージ、など) |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |

<br>

### メッシュトポロジー

| 能力 (執筆時点2023/03/11) | Kubernetes (サービスメッシュ採用せず) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------- | :-----------------------------------: | :---: | :-----: | :----: | :----------: |
| ダッシュボード            |               記入中...               |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |

<br>

## 07. アーキテクチャ

### サービスメッシュのパターン

| 能力 (執筆時点2023/03/11)  | Istio | Linkerd | Consul | AWS App Mesh |
| -------------------------- | :---: | :-----: | :----: | :----------: |
| サイドカープロキシメッシュ |  ⭕️  |   ⭕️   |  ⭕️   |     ⭕️      |
| Nodeプロキシメッシュ       |  ⭕️  |    ×    |   ×    |      ×       |

<br>

### 外部データプレーン

| 能力 (執筆時点2023/03/11)                                       | Istio | Linkerd | Consul | AWS App Mesh |
| --------------------------------------------------------------- | :---: | :-----: | :----: | :----------: |
| 異なるClusterにあるデータプレーンの管理 (マルチClusterメッシュ) |  ⭕️  |   ⭕️   |  ⭕️   |      ×       |
| 仮想サーバーにあるデータプレーンの管理                          |  ⭕️  |    ×    |  ⭕️   |     ⭕️      |

<br>

### Kubernetesとの親和性

| 能力 (執筆時点2023/03/11) | Istio | Linkerd | Consul | AWS App Mesh |
| ------------------------- | :---: | :-----: | :----: | :----------: |
| Ingressコントローラー     |  ⭕️  |   ⭕️   |  ⭕️   |      ×       |
| Egressコントローラー      |  ⭕️  |    ×    |   ×    |      ×       |
| カスタムリソース          |  ⭕️  |   ⭕️   |   ×    |      ×       |

<br>
