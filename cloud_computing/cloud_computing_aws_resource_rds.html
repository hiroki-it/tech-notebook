
<!doctype html>
<html lang="ja" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="RDS＠AWSリソース">
      
      
        <meta name="author" content="Hiroki Hasegawa">
      
      
        <link rel="canonical" href="https://hiroki-it.github.io/tech-notebook/cloud_computing/cloud_computing_aws_resource_rds.html">
      
      
        <link rel="prev" href="cloud_computing_aws_resource_lb.html">
      
      
        <link rel="next" href="cloud_computing_aws_resource_redshift.html">
      
      
      <link rel="icon" href="../assets/images/logo_v2.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.3.1">
    
    
      
        <title>【IT技術の知見】RDS＠AWSリソース - 俺の技術ノート</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.046329b4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.85d0ee34.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+Japanese:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans Japanese";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/css/custom.css">
    
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-HPJGWKTH9W"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-HPJGWKTH9W",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-HPJGWKTH9W",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="dark" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#rdsaws" class="md-skip">
          コンテンツにスキップ
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="ヘッダー">
    <a href="https://hiroki-it.github.io/tech-notebook/" title="俺の技術ノート" class="md-header__button md-logo" aria-label="俺の技術ノート" data-md-component="logo">
      
  <img src="../assets/images/logo_v2.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            俺の技術ノート
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              【IT技術の知見】RDS＠AWSリソース
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="検索" placeholder="検索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="検索">
        
        <button type="reset" class="md-search__icon md-icon" title="クリア" aria-label="クリア" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            検索を初期化
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hiroki-it/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHubアカウントはこちら
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="タブ" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../index.html" class="md-tabs__link">
        
  
    
  
  当サイトについて

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../about.html" class="md-tabs__link">
        
  
    
  
  『俺』

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../system/index.html" class="md-tabs__link">
          
  
    
  
  🌳 システム

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../software/index.html" class="md-tabs__link">
          
  
    
  
  🧬 ソフトウェア

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../software/application/index.html" class="md-tabs__link">
          
  
    
  
  🚀 アプリ

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../software/middleware/index.html" class="md-tabs__link">
          
  
    
  
  🤝🏻 ミドルウェア

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../software/basic/index.html" class="md-tabs__link">
          
  
    
  
  🐧 OS

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../language/index.html" class="md-tabs__link">
          
  
    
  
  🔠 言語

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../testing/index.html" class="md-tabs__link">
          
  
    
  
  🧪 テスト

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../hardware/index.html" class="md-tabs__link">
          
  
    
  
  💻 ハードウェア

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../network/index.html" class="md-tabs__link">
          
  
    
  
  🌏 ネットワーク

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../security/index.html" class="md-tabs__link">
          
  
    
  
  🔐 セキュリティ

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="index.html" class="md-tabs__link">
          
  
    
  
  ⛅️ 3大クラウド

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../virtualization/index.html" class="md-tabs__link">
          
  
    
  
  📦 仮想化

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../infrastructure_as_code/index.html" class="md-tabs__link">
          
  
    
  
  ⚙️ IaC

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../infrastructure_as_code/kubernetes/index.html" class="md-tabs__link">
          
  
    
  
  ☸️ K8s

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../infrastructure_as_code/kubernetes_addon/index.html" class="md-tabs__link">
          
  
    
  
  ⏬ K8sアドオン

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../infrastructure_as_code/cncf_projects/index.html" class="md-tabs__link">
          
  
    
  
  🌊 CNCF

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../devops/index.html" class="md-tabs__link">
          
  
    
  
  ♾️ DevOps

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../devops/cicd/index.html" class="md-tabs__link">
          
  
    
  
  🔄 CI/CD

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../observability/index.html" class="md-tabs__link">
          
  
    
  
  🔎 可観測性

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../software_development_methodology/index.html" class="md-tabs__link">
          
  
    
  
  👥 開発手法

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="ナビゲーション" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://hiroki-it.github.io/tech-notebook/" title="俺の技術ノート" class="md-nav__button md-logo" aria-label="俺の技術ノート" data-md-component="logo">
      
  <img src="../assets/images/logo_v2.png" alt="logo">

    </a>
    俺の技術ノート
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hiroki-it/" title="リポジトリへ" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHubアカウントはこちら
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    当サイトについて
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../about.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    『俺』
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../system/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🌳 システム
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../software/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🧬 ソフトウェア
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../software/application/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🚀 アプリ
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../software/middleware/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🤝🏻 ミドルウェア
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../software/basic/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🐧 OS
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../language/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🔠 言語
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../testing/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🧪 テスト
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../hardware/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    💻 ハードウェア
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../network/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🌏 ネットワーク
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../security/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🔐 セキュリティ
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="index.html" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    ⛅️ 3大クラウド
  </span>
  

            </a>
            
              <label class="md-nav__link " for="__nav_13">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            ⛅️ 3大クラウド
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3大クラウド
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_3" checked>
        
          <label class="md-nav__link" for="__nav_13_3" id="__nav_13_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ■ AWS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_13_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13_3">
            <span class="md-nav__icon md-icon"></span>
            ■ AWS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_cli.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AWS CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13_3_2" checked>
        
          <label class="md-nav__link" for="__nav_13_3_2" id="__nav_13_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ■ AWSリソース
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_13_3_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_13_3_2">
            <span class="md-nav__icon md-icon"></span>
            ■ AWSリソース
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_account.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    アカウント
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_amplify.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Amplify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="cloud_computing_aws_resource_api_gateway.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ■ API Gateway
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_autoscaling.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AutoScaling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_backup.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_certificate_manager.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Certificate Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_chatbot.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Chatbot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_cloudformation.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CloudFormation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_cloudfront.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CloudFront
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_cloudtrail.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CloudTrail
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_cloudwatch.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CloudWatch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_code.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code兄弟
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_control_tower.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Control Tower
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_direct_connect.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DirectConnect
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_ec2.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EC2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_ecr.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECR
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_ecs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ECS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_efs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_eks.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EKS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_elasticache.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ︎ElastiCache
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_eventbridge.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    EventBridge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_firelens.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FireLens
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_global_accelerator.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Global Accelerator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_glue.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_iam.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IAM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_kinesis.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kinesis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_kms.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KMS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="cloud_computing_aws_resource_lambda.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ■ Lambda
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_lb.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    RDS
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="cloud_computing_aws_resource_rds.html" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    RDS
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="このページの内容">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      このページの内容
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    はじめに
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-rdsrelational-database-service" class="md-nav__link">
    01. RDS：Relational Database Service
  </a>
  
    <nav class="md-nav" aria-label="01. RDS：Relational Database Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds" class="md-nav__link">
    RDSとは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-02" class="md-nav__link">
    01-02. セットアップ
  </a>
  
    <nav class="md-nav" aria-label="01-02. セットアップ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    コンソール画面の場合
  </a>
  
    <nav class="md-nav" aria-label="コンソール画面の場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db" class="md-nav__link">
    ▼ DBエンジン
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auroraaurora" class="md-nav__link">
    Auroraと非Aurora
  </a>
  
    <nav class="md-nav" aria-label="Auroraと非Aurora">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbmsrdb" class="md-nav__link">
    ▼ DBMSに対応するRDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ▼ 機能の違い
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    OSの隠蔽
  </a>
  
    <nav class="md-nav" aria-label="OSの隠蔽">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    ▼ OSの隠蔽とは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ▼ 確認方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    メンテナンスウインドウ
  </a>
  
    <nav class="md-nav" aria-label="メンテナンスウインドウ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ▼ メンテナンスウインドウ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ▼ メンテナンスの適切な曜日/時間帯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    ▼ 『保留中の変更』『保留中のメンテナンス』
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    ▼ 保留中のメンテナンスの状態
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    ▼ 『次のウィンドウ』状態の取り消し
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    ▼ 『保留中の変更』の取り消し
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-rds-aurora" class="md-nav__link">
    02. RDS (Aurora)
  </a>
  
    <nav class="md-nav" aria-label="02. RDS (Aurora)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds-aurora" class="md-nav__link">
    RDS (Aurora) とは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-02" class="md-nav__link">
    02-02. セットアップ
  </a>
  
    <nav class="md-nav" aria-label="02-02. セットアップ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    コンソール画面の場合
  </a>
  
    <nav class="md-nav" aria-label="コンソール画面の場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_1" class="md-nav__link">
    ▼ DBクラスター
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_2" class="md-nav__link">
    ▼ DBインスタンス
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-03-db" class="md-nav__link">
    02-03. DBクラスター
  </a>
  
    <nav class="md-nav" aria-label="02-03. DBクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_3" class="md-nav__link">
    DBクラスターとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_4" class="md-nav__link">
    空のDBクラスター
  </a>
  
    <nav class="md-nav" aria-label="空のDBクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_5" class="md-nav__link">
    ▼ 空のDBクラスターとは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    グローバルクラスター
  </a>
  
    <nav class="md-nav" aria-label="グローバルクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    ▼ グローバルクラスターとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ▼ アップグレード
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    ▼ スナップショット
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-04-db" class="md-nav__link">
    02-04. DBインスタンス
  </a>
  
    <nav class="md-nav" aria-label="02-04. DBインスタンス">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_6" class="md-nav__link">
    DBインスタンスとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_7" class="md-nav__link">
    DBインスタンスの種類
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    エンドポイント
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-05" class="md-nav__link">
    02-05. アップグレード
  </a>
  
    <nav class="md-nav" aria-label="02-05. アップグレード">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zdp" class="md-nav__link">
    ZDP (ゼロダウンタイムパッチ適用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    ダウンタイム
  </a>
  
    <nav class="md-nav" aria-label="ダウンタイム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    ▼ ダウンタイムとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    ▼ ダウンタイムの発生条件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    ▼ エンジンタイプによるダウンタイムの最小化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    ▼ ダウンタイムの計測例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    フェイルオーバー
  </a>
  
    <nav class="md-nav" aria-label="フェイルオーバー">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aurora" class="md-nav__link">
    ▼ Auroraのフェイルオーバーとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    ▼ フェイルオーバーによるダウンタイムの最小化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_8" class="md-nav__link">
    ▼ DBインスタンスの昇格優先順位
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    ▼ ダウンタイムを最小化できない場合
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-06" class="md-nav__link">
    02-06. 負荷対策
  </a>
  
    <nav class="md-nav" aria-label="02-06. 負荷対策">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    エンドポイントの使い分け
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autoscaling" class="md-nav__link">
    リードレプリカの手動追加、AutoScaling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    クエリキャッシュの利用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    ユニークキーまたはインデックスの利用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    テーブルを正規化し過ぎない
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    インスタンスタイプのスケールアップ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-07" class="md-nav__link">
    02-07. イベント
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-rds-aurora" class="md-nav__link">
    03. RDS (非Aurora)
  </a>
  
    <nav class="md-nav" aria-label="03. RDS (非Aurora)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    ダウンタイム
  </a>
  
    <nav class="md-nav" aria-label="ダウンタイム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    ▼ ダウンタイムの発生条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    フェイルオーバー
  </a>
  
    <nav class="md-nav" aria-label="フェイルオーバー">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds_1" class="md-nav__link">
    ▼ RDSのフェイルオーバーとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    ▼ フェイルオーバーによるダウンタイムの最小化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    イベント
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-rds" class="md-nav__link">
    04. RDSプロキシ
  </a>
  
    <nav class="md-nav" aria-label="04. RDSプロキシ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds_2" class="md-nav__link">
    RDSプロキシとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    コネクションプールの管理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_redshift.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redshift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_route53.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Route53
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_s3.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    S3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_secrets_manager.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Secrets Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_ses.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_sns.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_sqs.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SQS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_step_functions.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Step Functions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_sts.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    STS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_systems_manager.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Systems Manager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_vpc.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_waf.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WAF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_resource_work_mail.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WorkMail
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="cloud_computing_aws_policy_availability.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ■ 設計規約
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="cloud_computing_aws_tools.html" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ツール
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="cloud_computing_gcp_cli.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ■ GCP
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../virtualization/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    📦 仮想化
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../infrastructure_as_code/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ⚙️ IaC
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../infrastructure_as_code/kubernetes/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ☸️ K8s
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../infrastructure_as_code/kubernetes_addon/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ⏬ K8sアドオン
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../infrastructure_as_code/cncf_projects/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🌊 CNCF
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../devops/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    ♾️ DevOps
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../devops/cicd/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🔄 CI/CD
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../observability/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    🔎 可観測性
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../software_development_methodology/index.html" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    👥 開発手法
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="このページの内容">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      このページの内容
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    はじめに
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-rdsrelational-database-service" class="md-nav__link">
    01. RDS：Relational Database Service
  </a>
  
    <nav class="md-nav" aria-label="01. RDS：Relational Database Service">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds" class="md-nav__link">
    RDSとは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#01-02" class="md-nav__link">
    01-02. セットアップ
  </a>
  
    <nav class="md-nav" aria-label="01-02. セットアップ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    コンソール画面の場合
  </a>
  
    <nav class="md-nav" aria-label="コンソール画面の場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db" class="md-nav__link">
    ▼ DBエンジン
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auroraaurora" class="md-nav__link">
    Auroraと非Aurora
  </a>
  
    <nav class="md-nav" aria-label="Auroraと非Aurora">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dbmsrdb" class="md-nav__link">
    ▼ DBMSに対応するRDB
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ▼ 機能の違い
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#os" class="md-nav__link">
    OSの隠蔽
  </a>
  
    <nav class="md-nav" aria-label="OSの隠蔽">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#os_1" class="md-nav__link">
    ▼ OSの隠蔽とは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ▼ 確認方法
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    メンテナンスウインドウ
  </a>
  
    <nav class="md-nav" aria-label="メンテナンスウインドウ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ▼ メンテナンスウインドウ
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    ▼ メンテナンスの適切な曜日/時間帯
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    ▼ 『保留中の変更』『保留中のメンテナンス』
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    ▼ 保留中のメンテナンスの状態
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    ▼ 『次のウィンドウ』状態の取り消し
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    ▼ 『保留中の変更』の取り消し
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-rds-aurora" class="md-nav__link">
    02. RDS (Aurora)
  </a>
  
    <nav class="md-nav" aria-label="02. RDS (Aurora)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds-aurora" class="md-nav__link">
    RDS (Aurora) とは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-02" class="md-nav__link">
    02-02. セットアップ
  </a>
  
    <nav class="md-nav" aria-label="02-02. セットアップ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    コンソール画面の場合
  </a>
  
    <nav class="md-nav" aria-label="コンソール画面の場合">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_1" class="md-nav__link">
    ▼ DBクラスター
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_2" class="md-nav__link">
    ▼ DBインスタンス
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-03-db" class="md-nav__link">
    02-03. DBクラスター
  </a>
  
    <nav class="md-nav" aria-label="02-03. DBクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_3" class="md-nav__link">
    DBクラスターとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_4" class="md-nav__link">
    空のDBクラスター
  </a>
  
    <nav class="md-nav" aria-label="空のDBクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_5" class="md-nav__link">
    ▼ 空のDBクラスターとは
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    グローバルクラスター
  </a>
  
    <nav class="md-nav" aria-label="グローバルクラスター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    ▼ グローバルクラスターとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    ▼ アップグレード
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    ▼ スナップショット
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-04-db" class="md-nav__link">
    02-04. DBインスタンス
  </a>
  
    <nav class="md-nav" aria-label="02-04. DBインスタンス">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#db_6" class="md-nav__link">
    DBインスタンスとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_7" class="md-nav__link">
    DBインスタンスの種類
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    エンドポイント
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-05" class="md-nav__link">
    02-05. アップグレード
  </a>
  
    <nav class="md-nav" aria-label="02-05. アップグレード">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zdp" class="md-nav__link">
    ZDP (ゼロダウンタイムパッチ適用)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    ダウンタイム
  </a>
  
    <nav class="md-nav" aria-label="ダウンタイム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    ▼ ダウンタイムとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    ▼ ダウンタイムの発生条件
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    ▼ エンジンタイプによるダウンタイムの最小化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    ▼ ダウンタイムの計測例
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    フェイルオーバー
  </a>
  
    <nav class="md-nav" aria-label="フェイルオーバー">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aurora" class="md-nav__link">
    ▼ Auroraのフェイルオーバーとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    ▼ フェイルオーバーによるダウンタイムの最小化
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#db_8" class="md-nav__link">
    ▼ DBインスタンスの昇格優先順位
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    ▼ ダウンタイムを最小化できない場合
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-06" class="md-nav__link">
    02-06. 負荷対策
  </a>
  
    <nav class="md-nav" aria-label="02-06. 負荷対策">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    エンドポイントの使い分け
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#autoscaling" class="md-nav__link">
    リードレプリカの手動追加、AutoScaling
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    クエリキャッシュの利用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    ユニークキーまたはインデックスの利用
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    テーブルを正規化し過ぎない
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    インスタンスタイプのスケールアップ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#02-07" class="md-nav__link">
    02-07. イベント
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#03-rds-aurora" class="md-nav__link">
    03. RDS (非Aurora)
  </a>
  
    <nav class="md-nav" aria-label="03. RDS (非Aurora)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    ダウンタイム
  </a>
  
    <nav class="md-nav" aria-label="ダウンタイム">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    ▼ ダウンタイムの発生条件
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    フェイルオーバー
  </a>
  
    <nav class="md-nav" aria-label="フェイルオーバー">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds_1" class="md-nav__link">
    ▼ RDSのフェイルオーバーとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    ▼ フェイルオーバーによるダウンタイムの最小化
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    イベント
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#04-rds" class="md-nav__link">
    04. RDSプロキシ
  </a>
  
    <nav class="md-nav" aria-label="04. RDSプロキシ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rds_2" class="md-nav__link">
    RDSプロキシとは
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    コネクションプールの管理
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="rdsaws">RDS＠AWSリソース<a class="headerlink" href="#rdsaws" title="Permanent link">&para;</a></h1>
<h2 id="_1">はじめに<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本サイトにつきまして、以下をご認識のほど宜しくお願いいたします。</p>
<blockquote>
<ul>
<li><a href="https://hiroki-it.github.io/tech-notebook/">https://hiroki-it.github.io/tech-notebook/</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="01-rdsrelational-database-service">01. RDS：Relational Database Service<a class="headerlink" href="#01-rdsrelational-database-service" title="Permanent link">&para;</a></h2>
<h3 id="rds">RDSとは<a class="headerlink" href="#rds" title="Permanent link">&para;</a></h3>
<p><br></p>
<h2 id="01-02">01-02. セットアップ<a class="headerlink" href="#01-02" title="Permanent link">&para;</a></h2>
<h3 id="_2">コンソール画面の場合<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<h4 id="db">▼ DBエンジン<a class="headerlink" href="#db" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>説明</th>
<th>補足</th>
</tr>
</thead>
<tbody>
<tr>
<td>エンジンタイプ</td>
<td>ミドルウェアのDBMSの種類を設定する。</td>
<td></td>
</tr>
<tr>
<td>エディション</td>
<td>エンジンバージョンでAuroraを選択した場合の互換性を設定する。</td>
<td></td>
</tr>
<tr>
<td>エンジンバージョン</td>
<td>DBエンジンのバージョンを設定する。DBクラスター内の全てのDBインスタンスに適用される。</td>
<td>・Auroraであれば、<code>SELECT AURORA_VERSION()</code>を使用して、エンジンバージョンを確認できる。</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="auroraaurora">Auroraと非Aurora<a class="headerlink" href="#auroraaurora" title="Permanent link">&para;</a></h3>
<h4 id="dbmsrdb">▼ DBMSに対応するRDB<a class="headerlink" href="#dbmsrdb" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>DBMS</th>
<th>RDB</th>
<th>互換性</th>
</tr>
</thead>
<tbody>
<tr>
<td>Aurora</td>
<td>RDS</td>
<td>MySQL/PostgreSQL</td>
</tr>
<tr>
<td>MariaDB</td>
<td>RDS</td>
<td>MariaDB</td>
</tr>
<tr>
<td>MySQL</td>
<td>RDS</td>
<td>MySQL</td>
</tr>
<tr>
<td>PostgreSQL</td>
<td>RDS</td>
<td>PostgreSQL</td>
</tr>
</tbody>
</table>
<h4 id="_3">▼ 機能の違い<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<p>RDBがAuroraか非Auroraかで機能に差があり、Auroraの方が耐障害性や可用性が高い。</p>
<p>ただし、その分費用が高いことに注意する。</p>
<blockquote>
<ul>
<li><a href="https://www.ragate.co.jp/blog/articles/10234">https://www.ragate.co.jp/blog/articles/10234</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="os">OSの隠蔽<a class="headerlink" href="#os" title="Permanent link">&para;</a></h3>
<h4 id="os_1">▼ OSの隠蔽とは<a class="headerlink" href="#os_1" title="Permanent link">&para;</a></h4>
<p>RDSは、EC2内にDBMSが稼働したものであるが、このほとんどが隠蔽されている。</p>
<p>そのためdbサーバーのようには操作できず、OSのバージョン確認やSSH公開鍵認証を行えない。</p>
<blockquote>
<ul>
<li><a href="https://xtech.nikkei.com/it/article/COLUMN/20131108/516863/">https://xtech.nikkei.com/it/article/COLUMN/20131108/516863/</a></li>
</ul>
</blockquote>
<h4 id="_4">▼ 確認方法<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<p>Linux x86_64が使用されているところまでは確認できるが、Linuxのバージョンは隠蔽されている。</p>
<div class="highlight"><pre><span></span><code><span class="c1">-- Auroraの場合</span>
<span class="k">SHOW</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%version%&#39;</span><span class="p">;</span>

<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Variable_name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">Value</span><span class="w">                        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">aurora_version</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">2</span><span class="p">.</span><span class="mi">09</span><span class="p">.</span><span class="mi">0</span><span class="w">                       </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">innodb_version</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="w">                        </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">protocol_version</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w">                           </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">slave_type_conversions</span><span class="w">  </span><span class="o">|</span><span class="w">                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">tls_version</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">TLSv1</span><span class="p">,</span><span class="n">TLSv1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">TLSv1</span><span class="p">.</span><span class="mi">2</span><span class="w">        </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="k">version</span><span class="w">                 </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="mi">12</span><span class="o">-</span><span class="n">log</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_comment</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="n">Community</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="p">(</span><span class="n">GPL</span><span class="p">)</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_compile_machine</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x86_64</span><span class="w">                       </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_compile_os</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">Linux</span><span class="w">                        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">-- 非Auroraの場合</span>
<span class="k">SHOW</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%version%&#39;</span><span class="p">;</span>

<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Variable_name</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">Value</span><span class="w">                        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">innodb_version</span><span class="w">          </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="w">                        </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">protocol_version</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="mi">10</span><span class="w">                           </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">slave_type_conversions</span><span class="w">  </span><span class="o">|</span><span class="w">                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">tls_version</span><span class="w">             </span><span class="o">|</span><span class="w"> </span><span class="n">TLSv1</span><span class="p">,</span><span class="n">TLSv1</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="n">TLSv1</span><span class="p">.</span><span class="mi">2</span><span class="w">        </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="k">version</span><span class="w">                 </span><span class="o">|</span><span class="w"> </span><span class="mi">5</span><span class="p">.</span><span class="mi">7</span><span class="p">.</span><span class="mi">0</span><span class="o">-</span><span class="n">log</span><span class="w">                    </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_comment</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="k">Source</span><span class="w"> </span><span class="n">distribution</span><span class="w">          </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_compile_machine</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">x86_64</span><span class="w">                       </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">version_compile_os</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">Linux</span><span class="w">                        </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-------------------------+------------------------------+</span>
</code></pre></div>
<p><br></p>
<h3 id="_5">メンテナンスウインドウ<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<h4 id="_6">▼ メンテナンスウインドウ<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h4>
<p>DBクラスター/DBインスタンスの設定の変更をスケジューリングする。</p>
<blockquote>
<ul>
<li><a href="https://dev.classmethod.jp/articles/amazon-rds-maintenance-questions/">https://dev.classmethod.jp/articles/amazon-rds-maintenance-questions/</a></li>
</ul>
</blockquote>
<h4 id="_7">▼ メンテナンスの適切な曜日/時間帯<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h4>
<p>CloudWatchメトリクスの<code>DatabaseConnections</code>メトリクスから、DBの接続数が低くなる時間帯を調査し、その時間帯にメンテナンスウィンドウを設定する。</p>
<p>また、メンテナンスウィンドウの実施曜日が週末であると、サイトが停止したまま休日を迎える可能性があるため、週末以外になるように設定する (メンテナンスウィンドウがUTCであることに注意) 。</p>
<h4 id="_8">▼ 『保留中の変更』『保留中のメンテナンス』<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h4>
<p><img alt="rds_pending-maintenance" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds_pending-maintenance.png" /></p>
<p>ユーザーが予定した設定変更は『保留中の変更』として表示される一方で、AWSによって定期的に行われるハードウェア/OS/DBエンジンのバージョンを強制アップグレードは『保留中のメンテナンス』として表示される。</p>
<p>『次のメンテナンスウィンドウ』を選択すれば実行タイミングをメンテナンスウィンドウの間設定できるが、これを行わない場合は『日付の適用』に表示された時間帯に強制実行される。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Maintenance.html">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.Maintenance.html</a></li>
</ul>
</blockquote>
<p>補足として保留中のメンテナンスは、アクションの『今すぐアップグレード』と『次のウィンドウでアップグレード』からも操作できる。</p>
<p><img alt="rds_pending-maintenance_action" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds_pending-maintenance_action.png" /></p>
<blockquote>
<ul>
<li><a href="https://dev.classmethod.jp/articles/rds-pending-maintenance-actions/">https://dev.classmethod.jp/articles/rds-pending-maintenance-actions/</a></li>
</ul>
</blockquote>
<h4 id="_9">▼ 保留中のメンテナンスの状態<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>状態</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>必須</td>
<td>アクションは実行可能かつ必須である。実行タイミングは未定であるが、適用期限日には必ず実行され、これは延期できない。</td>
</tr>
<tr>
<td>利用可能</td>
<td>アクションは実行できるが、推奨である。実行タイミングは未定である。</td>
</tr>
<tr>
<td>次のウィンドウ</td>
<td>アクションの実行タイミングは、次回のメンテナンスウィンドウである。後でアップグレードを選択することにより、『利用可能』の状態に戻すことも可能。</td>
</tr>
<tr>
<td>進行中</td>
<td>現在時刻がメンテナンスウィンドウに含まれており、アクションを実行中である。</td>
</tr>
</tbody>
</table>
<h4 id="_10">▼ 『次のウィンドウ』状態の取り消し<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<p>設定の変更が『次のウィンドウ』状態にある場合、画面上からは『必須』や『利用可能』といった実行タイミングが未定の状態に戻せない。</p>
<p>しかし、CLIを使用すると戻せる。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>aws<span class="w"> </span>rds<span class="w"> </span>describe-pending-maintenance-actions<span class="w"> </span>--output<span class="o">=</span>table

-----------------------------------------------------------------------------------
<span class="p">|</span><span class="w">                        </span>DescribePendingMaintenanceActions<span class="w">                        </span><span class="p">|</span>
+---------------------------------------------------------------------------------+
<span class="o">||</span><span class="w">                           </span>PendingMaintenanceActions<span class="w">                           </span><span class="o">||</span>
<span class="p">|</span>+---------------------+---------------------------------------------------------+<span class="p">|</span>
<span class="o">||</span><span class="w">  </span>ResourceIdentifier<span class="w"> </span><span class="p">|</span><span class="w">  </span>arn:aws:rds:ap-northeast-1:&lt;AWSアカウントID&gt;:db:prd-foo-instance<span class="w">   </span><span class="o">||</span>
<span class="p">|</span>+---------------------+---------------------------------------------------------+<span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">                       </span>PendingMaintenanceActionDetails<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span>+--------------------------+--------------------------------------------------+<span class="o">||</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>Action<span class="w">                  </span><span class="p">|</span><span class="w">  </span>system-update<span class="w"> </span><span class="c1"># 予定されたアクション                |||</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>AutoAppliedAfterDate<span class="w">    </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-01-31T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>CurrentApplyDate<span class="w">        </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-01-31T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>Description<span class="w">             </span><span class="p">|</span><span class="w">  </span>New<span class="w"> </span>Operating<span class="w"> </span>System<span class="w"> </span>update<span class="w"> </span>is<span class="w"> </span>available<span class="w">        </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>ForcedApplyDate<span class="w">         </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-03-30T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span>+--------------------------+--------------------------------------------------+<span class="o">||</span>
<span class="o">||</span><span class="w">                           </span>PendingMaintenanceActions<span class="w">                           </span><span class="o">||</span>
<span class="p">|</span>+---------------------+---------------------------------------------------------+<span class="p">|</span>
<span class="o">||</span><span class="w">  </span>ResourceIdentifier<span class="w"> </span><span class="p">|</span><span class="w">  </span>arn:aws:rds:ap-northeast-1:&lt;AWSアカウントID&gt;:db:prd-bar-instance<span class="w">   </span><span class="o">||</span>
<span class="p">|</span>+---------------------+---------------------------------------------------------+<span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">                       </span>PendingMaintenanceActionDetails<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span>+--------------------------+--------------------------------------------------+<span class="o">||</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>Action<span class="w">                  </span><span class="p">|</span><span class="w">  </span>system-update<span class="w">                                   </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>AutoAppliedAfterDate<span class="w">    </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-01-31T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>CurrentApplyDate<span class="w">        </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-01-31T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>Description<span class="w">             </span><span class="p">|</span><span class="w">  </span>New<span class="w"> </span>Operating<span class="w"> </span>System<span class="w"> </span>update<span class="w"> </span>is<span class="w"> </span>available<span class="w">        </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span><span class="p">|</span><span class="w">  </span>ForcedApplyDate<span class="w">         </span><span class="p">|</span><span class="w">  </span><span class="m">2022</span>-03-30T00:00:00+00:00<span class="w">                       </span><span class="o">||</span><span class="p">|</span>
<span class="o">||</span>+--------------------------+--------------------------------------------------+<span class="o">||</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>aws<span class="w"> </span>rds<span class="w"> </span>apply-pending-maintenance-action<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--resource-identifier<span class="w"> </span>arn:aws:rds:ap-northeast-1:&lt;AWSアカウントID&gt;:db:prd-foo-instance<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--opt-in-type<span class="w"> </span>undo-opt-in<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--apply-action<span class="w"> </span>&lt;取り消したいアクション名&gt;
</code></pre></div>
<blockquote>
<ul>
<li><a href="https://dev.classmethod.jp/articles/mean-of-next-window-in-pending-maintenance-and-set-maintenance-schedule/">https://dev.classmethod.jp/articles/mean-of-next-window-in-pending-maintenance-and-set-maintenance-schedule/</a></li>
</ul>
</blockquote>
<h4 id="_11">▼ 『保留中の変更』の取り消し<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<p>保留中の変更を画面上からは取り消せない。</p>
<p>しかし、CLIを使用すると戻せる。</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>aws<span class="w"> </span>rds<span class="w"> </span>modify-db-instance<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--db-instance-identifier<span class="w"> </span>prd-foo-instance<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>&lt;変更前の設定項目&gt;<span class="w"> </span>&lt;変更前の設定値&gt;<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--apply-immediately
</code></pre></div>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately</a></li>
<li><a href="https://qiita.com/tinoji/items/e150ffdc2045e8b85a56">https://qiita.com/tinoji/items/e150ffdc2045e8b85a56</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="02-rds-aurora">02. RDS (Aurora)<a class="headerlink" href="#02-rds-aurora" title="Permanent link">&para;</a></h2>
<h3 id="rds-aurora">RDS (Aurora) とは<a class="headerlink" href="#rds-aurora" title="Permanent link">&para;</a></h3>
<p><br></p>
<h2 id="02-02">02-02. セットアップ<a class="headerlink" href="#02-02" title="Permanent link">&para;</a></h2>
<h3 id="_12">コンソール画面の場合<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h3>
<h4 id="db_1">▼ DBクラスター<a class="headerlink" href="#db_1" title="Permanent link">&para;</a></h4>
<p>ベストプラクティスについては、以下のリンクを参考にせよ。</p>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>説明</th>
<th>補足</th>
</tr>
</thead>
<tbody>
<tr>
<td>レプリケーション</td>
<td>単一のプライマリーインスタンス (シングルマスター) または複数のプライマリーインスタンス (マルチマスター) とするかを設定する。</td>
<td>フェイルオーバーを利用したダウンタイムの最小化時に、マルチマスターであれば変更の順番を気にしなくてよくなる。ただし、DBクラスターをクローンできないなどのデメリットもある。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-multi-master.html#aurora-multi-master-terms">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-multi-master.html#aurora-multi-master-terms</a></td>
</tr>
<tr>
<td>DBクラスター識別子</td>
<td>DBクラスター名を設定する。</td>
<td>インスタンス名は、最初に設定できず、RDSの作成後に設定できる。</td>
</tr>
<tr>
<td>VPCとサブネットグループ</td>
<td>DBクラスターを配置するVPCとサブネットを設定する。</td>
<td>DBが配置されるサブネットはプライベートサブネットにする、これには、data storeサブネットと名付ける。アプリケーション以外は、踏み台サーバー経由でしかDBにアクセスできないようにする。<br><img alt="subnet_component-type" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/subnet_component-type.png" /></td>
</tr>
<tr>
<td>パラメーターグループ</td>
<td>グローバルパラメーターを設定する。</td>
<td>デフォルトを使用せずに独自定義する場合、事前に作成しておく必要がある。クラスターパラメーターグループとインスタンスパラメーターグループがあるが、全てのインスタンスに同じパラメーターループを設定する必要があるなため、クラスターパラメーターを使用すれば良い。各パラメーターに適用タイプ (dynamic/static) があり、dynamicタイプは設定の適用に再起動が必要である。新しく作成したクラスタパラメーターグループにて以下の値を設定すると良い。<br>・<code>time_zone=Asia/Tokyo</code><br>・<code>character_set_client=utf8mb4</code><br>・<code>character_set_connection=utf8mb4</code><br>・<code>character_set_database=utf8mb4</code><br>・<code>character_set_results=utf8mb4</code><br>・<code>character_set_server=utf8mb4</code><br>・<code>server_audit_logging=1</code> (監査ログをCloudWatchに送信するか否か) <br>・<code>server_audit_logs_upload=1</code><br>・<code>general_log=1</code> (通常クエリログをCloudWatchに送信するか否か) <br>・<code>slow_query_log=1</code> (スロークエリログをCloudWatchに送信するか否か) <br>・<code>long_query_time=3</code> (スロークエリと見なす最短秒数)</td>
</tr>
<tr>
<td>DB認証</td>
<td>DBに接続するための認証方法を設定する。</td>
<td>各DBインスタンスに異なるDB認証を設定できるが、全てのDBインスタンスに同じ認証方法を設定すべきなため、DBクラスターでこれを設定すれば良い。</td>
</tr>
<tr>
<td>マスタユーザー名</td>
<td>DBのrootユーザーを設定</td>
<td></td>
</tr>
<tr>
<td>マスターパスワード</td>
<td>DBのrootユーザーのパスワードを設定</td>
<td></td>
</tr>
<tr>
<td>バックアップ保持期間</td>
<td>DBクラスター がバックアップを保持する期間を設定する。</td>
<td><code>7</code>日間にしておく。</td>
</tr>
<tr>
<td>ログのエクスポート</td>
<td>CloudWatchログに送信するログを設定する。</td>
<td>必ず、全てのログを選択すること。</td>
</tr>
<tr>
<td>セキュリティグループ</td>
<td>DBクラスターのセキュリティグループを設定する。</td>
<td>コンピューティングからのインバウンド通信のみを許可するように、これらのプライベートIPアドレス (<code>*.*.*.*/32</code>) を設定する。</td>
</tr>
<tr>
<td>削除保護</td>
<td>DBクラスターの削除を防ぐ。</td>
<td>DBクラスターを削除するとクラスターボリュームも削除されるため、これを防ぐ。補足として、DBクラスターの削除保護になっていてもDBインスタンスは削除できる。DBインスタンスを削除しても、再作成すればクラスターボリュームに接続されて元のデータにアクセスできる。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeletionProtection">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeletionProtection</a></td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><a href="https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/">https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/</a></li>
</ul>
</blockquote>
<h4 id="db_2">▼ DBインスタンス<a class="headerlink" href="#db_2" title="Permanent link">&para;</a></h4>
<p>ベストプラクティスについては、以下のリンクを参考にせよ。</p>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>説明</th>
<th>補足</th>
</tr>
</thead>
<tbody>
<tr>
<td>インスタンスクラス</td>
<td>DBインスタンスのスペックを設定する。</td>
<td>バースト可能クラスを選択すること。補足として、AuroraのDBサイズは自動的にスケーリングするため、設定する必要がない。</td>
</tr>
<tr>
<td>パブリックアクセス</td>
<td>DBインスタンスにIPアドレスを割り当てるか否かを設定する。</td>
<td></td>
</tr>
<tr>
<td>キャパシティタイプ</td>
<td></td>
<td></td>
</tr>
<tr>
<td>マルチAZ配置</td>
<td>プライマリーインスタンスとは別に、リードレプリカをマルチAZ配置で追加するか否かを設定する。</td>
<td>後からでもリードレプリカを追加できる。また、フェイルオーバー時にリードレプリカが存在していなければ、昇格後のプライマリーインスタンスが自動的に作成される。</td>
</tr>
<tr>
<td>最初のDB名</td>
<td>DBインスタンスに自動的に作成されるDB名を設定</td>
<td></td>
</tr>
<tr>
<td>マイナーバージョンの自動アップグレード</td>
<td>DBインスタンスのDBエンジンのバージョンを自動的に更新するかを設定する。</td>
<td>開発環境では有効化、本番環境とステージング環境では無効化しておく。開発環境で新バージョンに問題が起こらなければ、ステージング環境と本番環境にも適用する。</td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><a href="https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/">https://www.trendmicro.com/cloudoneconformity/knowledge-base/aws/RDS/</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="02-03-db">02-03. DBクラスター<a class="headerlink" href="#02-03-db" title="Permanent link">&para;</a></h2>
<h3 id="db_3">DBクラスターとは<a class="headerlink" href="#db_3" title="Permanent link">&para;</a></h3>
<p>DBエンジンにAuroraを選択した場合にのみ使用できる。</p>
<p>DBインスタンスとクラスターボリュームから構成されている。</p>
<p>コンピューティングとして動作するDBインスタンスと、ストレージとして動作するクラスターボリュームが分離されているため、DBインスタンスが誤って全て削除されてしまったとしても、データを守れる。</p>
<p>また、両者が分離されていないエンジンタイプと比較して、再起動が早いため、再起動に伴うダウンタイムが短い。</p>
<p><img alt="aurora-db-cluster" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/aurora-db-cluster.png" /></p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="db_4">空のDBクラスター<a class="headerlink" href="#db_4" title="Permanent link">&para;</a></h3>
<h4 id="db_5">▼ 空のDBクラスターとは<a class="headerlink" href="#db_5" title="Permanent link">&para;</a></h4>
<p>コンソール画面にて、DBクラスター内の全てのDBインスタンスを削除すると、DBクラスターも自動的に削除される。</p>
<p>一方で、AWS-APIをコールして全てのDBインスタンスを削除する場合、DBクラスターは自動的に削除されずに、空の状態になる。</p>
<p>例えば、Terraformを使用してDBクラスターを作成する時に、インスタンスの作成に失敗するとDBクラスターが空になる、</p>
<p>これは、TerraformがAWS-APIをコールした作成を行っているためである。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeleteCluster.DeleteCluster">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_DeleteCluster.html#USER_DeleteCluster.DeleteCluster</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="_13">グローバルクラスター<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h3>
<h4 id="_14">▼ グローバルクラスターとは<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<p><img alt="aurora-db-cluster_global" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/aurora-db-cluster_global.png" /></p>
<p>リージョン間に跨いだDBクラスターから構成されている。</p>
<p>メインリージョンにあるプライマリークラスターのクラスターボリュームと、DRリージョンのセカンダリークラスターのクラスターボリュームのデータは、定期的に同期される。</p>
<p>プライマリーインスタンスは、プライマリークラスターのみに存在している。</p>
<p>メインリージョンで障害が起こった場合は、以下が起こる。</p>
<dl>
<dt><code>(1)</code></dt>
<dd>
<p>メインリージョンで障害が発生する。</p>
</dd>
<dt><code>(2)</code></dt>
<dd>
<p>DRリージョンのセカンダリークラスターがプライマリークラスターに昇格し、クラスター内のリードレプリカインスタンスがプライマリーインスタンスになる。</p>
</dd>
<dt><code>(3)</code></dt>
<dd>
<p>メインリージョンのプライマリーインスタンスをフェイルオーバーさせる。各種エンドポイントが無効化され、アクセスできなくなる (<code>NXDOMAIN</code>になる) 。</p>
</dd>
<dt><code>(4)</code></dt>
<dd>
<p>メインリージョンの障害が復旧する。</p>
</dd>
<dt><code>(5)</code></dt>
<dd>
<p>DRリージョンをフェイルオーバーさせる。メインリージョンのクラスターがプライマリークラスター、DRリージョンのクラスターがセカンダリークラスターになる。</p>
</dd>
</dl>
<blockquote>
<ul>
<li><a href="https://dev.classmethod.jp/articles/amazon-aurora-global-database-failover-between-region/">https://dev.classmethod.jp/articles/amazon-aurora-global-database-failover-between-region/</a></li>
<li><a href="https://qiita.com/minorun365/items/2530cf1d1f5793c15c79">https://qiita.com/minorun365/items/2530cf1d1f5793c15c79</a></li>
</ul>
</blockquote>
<p>注意点として、通常のAurora DBクラスターと比較して、機能が制限される。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-global-database.html#aurora-global-database.limitations">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-global-database.html#aurora-global-database.limitations</a></li>
</ul>
</blockquote>
<h4 id="_15">▼ アップグレード<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<p>グローバルクラスターでは、プライマリークラスターとセカンダリークラスターを同時にアップグレードできない。</p>
<p>マイナーバージョンのアップグレードの場合は、セカンダリクラスターからアップグレードする。</p>
<p>メジャーバージョンのアップグレードの場合は、グローバルクラスター自体をアップグレードする。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-global-database-upgrade.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/aurora-global-database-upgrade.html</a></li>
</ul>
</blockquote>
<p><br></p>
<h4 id="_16">▼ スナップショット<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<p>グローバルクラスターでは、リージョン間でデータをコピーしている。</p>
<p>そのため、メインリージョンのプライマリークラスターでスナップショットを作成し、これをDRリージョンにコピーするようにする。</p>
<blockquote>
<ul>
<li><a href="https://dev.classmethod.jp/articles/lim-rds-move-region-jp/#toc-7">https://dev.classmethod.jp/articles/lim-rds-move-region-jp/#toc-7</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="02-04-db">02-04. DBインスタンス<a class="headerlink" href="#02-04-db" title="Permanent link">&para;</a></h2>
<h3 id="db_6">DBインスタンスとは<a class="headerlink" href="#db_6" title="Permanent link">&para;</a></h3>
<p>コンピューティング機能を持ち、クラスターボリュームを操作できる。</p>
<p><br></p>
<h3 id="db_7">DBインスタンスの種類<a class="headerlink" href="#db_7" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th></th>
<th>プライマリーインスタンス</th>
<th>リードレプリカ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ロール</td>
<td>読み出し/書き込みインスタンス</td>
<td>読み出しオンリーインスタンス</td>
</tr>
<tr>
<td>CRUD制限</td>
<td>制限なし。ユーザーの認可スコープに依存する。</td>
<td>ユーザーの認可スコープに関係なく、READしか実行できない。</td>
</tr>
<tr>
<td>エンドポイント</td>
<td>各DBインスタンスに、リージョンのイニシャルに合わせたエンドポイントが割り振られる。</td>
<td>各DBインスタンスに、リージョンのイニシャルに合わせたエンドポイントが割り振られる。</td>
</tr>
<tr>
<td>データ同期</td>
<td>DBクラスターに対するデータ変更を受けつける。</td>
<td>読み出し/書き込みインスタンスのデータの変更が同期される。</td>
</tr>
</tbody>
</table>
<p><br></p>
<h3 id="_17">エンドポイント<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<p><img alt="rds_endpoint" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds_endpoint.png" /></p>
<table>
<thead>
<tr>
<th>エンドポイント名</th>
<th>役割</th>
<th>エンドポイント：ポート番号</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>クラスターエンドポイント</td>
<td>書き込み/読み出し</td>
<td><code>&lt;DBクラスター名&gt;.cluster-&lt;id&gt;.ap-northeast-1.rds.amazonaws.com:&lt;ポート番号&gt;</code></td>
<td>プライマリーインスタンスに通信できる。プライマリーインスタンスがダウンし、フェイルオーバーによってプライマリーインスタンスとリードレプリカが入れ替わった場合、エンドポイントの転送先は新しいプライマリーインスタンスに変更される。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Overview.Endpoints.html#Aurora.Endpoints.Cluster">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Overview.Endpoints.html#Aurora.Endpoints.Cluster</a></td>
</tr>
<tr>
<td>リーダーエンドポイント</td>
<td>読み出し</td>
<td><code>&lt;DBクラスター名&gt;.cluster-ro-&lt;id&gt;.ap-northeast-1.rds.amazonaws.com:&lt;ポート番号&gt;</code></td>
<td>リードレプリカに通信できる。DBインスタンスが複数ある場合、クエリが自動的に割り振られる。フェイルオーバーによってプライマリーインスタンスとリードレプリカが入れ替わった場合、エンドポイントの転送先は新しいプライマリーインスタンスに変更される。もしリードレプリカが全てダウンし、プライマリーインスタンスしか稼働していない状況の場合、プライマリーインスタンスに転送するようになる。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Overview.Endpoints.html#Aurora.Endpoints.Reader">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Overview.Endpoints.html#Aurora.Endpoints.Reader</a></td>
</tr>
<tr>
<td>インスタンスエンドポイント</td>
<td></td>
<td><code>&lt;DBインスタンス名&gt;.cwgrq25vlygf.ap-northeast-1.rds.amazonaws.com:&lt;ポート番号&gt;</code></td>
<td>選択したDBインスタンスに通信できる。フェイルオーバーによってプライマリーインスタンスとリードレプリカが入れ替わっても、エンドポイントそのままなため、アプリケーションが影響を付ける。非推奨である。</td>
</tr>
</tbody>
</table>
<p><br></p>
<h2 id="02-05">02-05. アップグレード<a class="headerlink" href="#02-05" title="Permanent link">&para;</a></h2>
<h3 id="zdp">ZDP (ゼロダウンタイムパッチ適用)<a class="headerlink" href="#zdp" title="Permanent link">&para;</a></h3>
<p><img alt="zero-downtime-patching" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/zero-downtime-patching.png" /></p>
<p>Auroraをエンジンバージョンに選択した場合に使用できる。</p>
<p>特定の条件下でのみ、アプリケーションとプライマリーインスタンスの接続を維持したまま、プライマリーインスタンスのパッチバージョンをアップグレードできる。</p>
<p>ゼロダウンタイムパッチ適用が発動した場合、RDSのイベントが記録される。</p>
<p>ただし、この機能に頼り切らない方が良い。</p>
<p>ゼロダウンタイムパッチ適用の発動はAWSから事前にお知らせされるわけでもなく、ユーザーが条件を見て発動の有無を判断しなければならない。</p>
<p>また、実際に発動していても、ダウンタイムが発生した事例が報告されている。</p>
<p>ゼロダウンタイムパッチ適用時、以下の手順でエンジンバージョンがアップグレードされる。</p>
<dl>
<dt><code>(1)</code></dt>
<dd>
<p>プライマリーインスタンスのエンジンがアップグレードされ、この時にダウンタイムが発生しない代わりに、<code>5</code>秒ほどプライマリーインスタンスの性能が低下する。</p>
</dd>
<dt><code>(2)</code></dt>
<dd>
<p>リードレプリカが再起動され、この時に<code>20</code>～<code>30</code>秒ほどダウンタイムが発生する。これらの仕組みのため、アプリケーションでは読み出しエンドポイントを接続先として使用しないようにする必要がある。</p>
</dd>
</dl>
<blockquote>
<ul>
<li><a href="https://qiita.com/tonishy/items/542f7dd10cc43fd299ab">https://qiita.com/tonishy/items/542f7dd10cc43fd299ab</a></li>
<li><a href="https://qiita.com/tmiki/items/7ade95c33b8e43c7cb5f">https://qiita.com/tmiki/items/7ade95c33b8e43c7cb5f</a></li>
<li><a href="https://noname.work/2407.html">https://noname.work/2407.html</a></li>
<li><a href="https://www.yuulinux.tokyo/8070/">https://www.yuulinux.tokyo/8070/</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="_18">ダウンタイム<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<h4 id="_19">▼ ダウンタイムとは<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<p>Auroraでは、設定値 (例：OS、エンジンバージョン、MySQL) のアップグレード時に、DBインスタンスの再起動が必要である。</p>
<p>再起動に伴ってダウンタイムが発生し、アプリケーションからDBに接続できなくなる。</p>
<p>この間、アプリケーションの利用者に与える影響を小さくできるように、計画的にダウンタイムを発生させる必要がある。</p>
<h4 id="_20">▼ ダウンタイムの発生条件<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<p>非Auroraに記載された情報のため、厳密にはAuroraのダウンタイムではない。</p>
<p>ただし、経験上同じ項目でダウンタイムが発生しているため、参考にする。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings</a></li>
</ul>
</blockquote>
<h4 id="_21">▼ エンジンタイプによるダウンタイムの最小化<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<p>コンピューティングとストレージが分離しているAuroraはエンジンタイプの中でもダウンタイムが短い。</p>
<h4 id="_22">▼ ダウンタイムの計測例<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<p>アプリケーションにリクエストを送信する方法と、RDSにクエリを直接的に送信する方法がある。</p>
<p>レスポンスとRDSイベントログから、ダウンタイムを計測する。</p>
<p><strong>＊実装例＊</strong></p>
<p>Aurora MySQLのアップグレードに伴うダウンタイムを計測する。</p>
<p>踏み台サーバーを経由してRDSに接続し、現在時刻を取得するSQLを送信する。</p>
<p>この時、<code>for</code>文や<code>watch</code>コマンドを使用する。</p>
<p>ただし、<code>watch</code>コマンドはプリインストールされていない可能性がある。</p>
<p>平常アクセス時のも同時に実行することにより、より正確なダウンタイムを取得する。</p>
<p>また、ヘルスチェックの時刻を正しくロギングできるように、ローカルマシンから時刻を取得する。</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-x

<span class="nv">BASTION_HOST</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">BASTION_USER</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_HOST</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_USER</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">SECRET_KEY</span><span class="o">=</span><span class="s2">&quot;~/.ssh/foo.pem&quot;</span>
<span class="nv">SQL</span><span class="o">=</span><span class="s2">&quot;SELECT NOW();&quot;</span>

ssh<span class="w"> </span>-o<span class="w"> </span><span class="nv">serveraliveinterval</span><span class="o">=</span><span class="m">60</span><span class="w"> </span>-f<span class="w"> </span>-N<span class="w"> </span>-L<span class="w"> </span><span class="m">3306</span>:<span class="si">${</span><span class="nv">DB_HOST</span><span class="si">}</span>:3306<span class="w"> </span>-i<span class="w"> </span><span class="si">${</span><span class="nv">SECRET_KEY</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">BASTION_USER</span><span class="si">}</span>@<span class="si">${</span><span class="nv">BASTION_HOST</span><span class="si">}</span><span class="w"> </span>-p<span class="w"> </span><span class="m">22</span>

<span class="c1"># 約15分間コマンドを繰り返す。</span>
<span class="k">for</span><span class="w"> </span>i<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="o">{</span><span class="m">1</span>..900<span class="o">}</span><span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;---------- No. </span><span class="si">${</span><span class="nv">i</span><span class="si">}</span><span class="s2"> Local PC: </span><span class="k">$(</span>date<span class="w"> </span>+<span class="s2">&quot;%Y-%m-%d %H:%M:%S&quot;</span><span class="k">)</span><span class="s2"> ------------&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>health_check.txt
<span class="w">  </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$SQL</span><span class="s2">&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$DB_USER</span><span class="s2">&quot;</span><span class="w"> </span>-P<span class="w"> </span><span class="m">3306</span><span class="w"> </span>-p<span class="s2">&quot;</span><span class="nv">$DB_PASSWORD</span><span class="s2">&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>health_check.txt<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<span class="w">  </span><span class="c1"># 1秒待機する。</span>
<span class="w">  </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="k">done</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="nb">set</span><span class="w"> </span>-x

<span class="nv">BASTION_HOST</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">BASTION_USER</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_HOST</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_PASSWORD</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">DB_USER</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">SECRET_KEY</span><span class="o">=</span><span class="s2">&quot;~/.ssh/foo.pem&quot;</span>
<span class="nv">SQL</span><span class="o">=</span><span class="s2">&quot;SELECT NOW();&quot;</span>

ssh<span class="w"> </span>-o<span class="w"> </span><span class="nv">serveraliveinterval</span><span class="o">=</span><span class="m">60</span><span class="w"> </span>-f<span class="w"> </span>-N<span class="w"> </span>-L<span class="w"> </span><span class="m">3306</span>:<span class="si">${</span><span class="nv">DB_HOST</span><span class="si">}</span>:3306<span class="w"> </span>-i<span class="w"> </span><span class="si">${</span><span class="nv">SECRET_KEY</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">BASTION_USER</span><span class="si">}</span>@<span class="si">${</span><span class="nv">BASTION_HOST</span><span class="si">}</span><span class="w"> </span>-p<span class="w"> </span><span class="m">22</span>

<span class="c1"># 1秒ごとにコマンドを繰り返す。</span>
watch<span class="w"> </span>-n<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="s1">&#39;echo &quot;---------- No. ${i} Local PC: $(date +&quot;%Y-%m-%d %H:%M:%S&quot;) ------------&quot; &gt;&gt; health_check.txt &amp;&amp; \</span>
<span class="s1">  echo ${SQL} | mysql -u ${DB_USER} -P 3306 -p${DB_PASSWORD} &gt;&gt; health_check.txt 2&gt;&amp;1&#39;</span>
</code></pre></div>
<p>上記のシェルスクリプトにより、例えば次のようなログを取得できる。</p>
<p>このログからは、<code>15:23:09</code> 〜 <code>15:23:14</code>の間で、接続に失敗していることを確認できる。</p>
<div class="highlight"><pre><span></span><code>---------- No. 242 Local PC: 2021-04-21 15:23:06 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
NOW()
2021-04-21 06:23:06
---------- No. 243 Local PC: 2021-04-21 15:23:07 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
NOW()
2021-04-21 06:23:08
---------- No. 244 Local PC: 2021-04-21 15:23:08 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2026 (HY000): SSL connection error: error:00000000:lib(0):func(0):reason(0)
---------- No. 245 Local PC: 2021-04-21 15:23:09 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2013 (HY000): Lost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0
---------- No. 246 Local PC: 2021-04-21 15:23:10 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2013 (HY000): Lost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0
---------- No. 247 Local PC: 2021-04-21 15:23:11 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2013 (HY000): Lost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0
---------- No. 248 Local PC: 2021-04-21 15:23:13 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2013 (HY000): Lost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0
---------- No. 249 Local PC: 2021-04-21 15:23:14 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
ERROR 2013 (HY000): Lost connection to MySQL server at &#39;reading initial communication packet&#39;, system error: 0
---------- No. 250 Local PC: 2021-04-21 15:23:15 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
NOW()
2021-04-21 06:23:16
---------- No. 251 Local PC: 2021-04-21 15:23:16 ------------
mysql: [Warning] Using a password on the command line interface can be insecure.
NOW()
2021-04-21 06:23:17
</code></pre></div>
<p>アップグレード時のプライマリーインスタンスのRDSイベントログは以下の通りで、ログによるダウンタイムは、再起動からシャットダウンまでの期間と一致することを確認する。</p>
<p><img alt="rds-event-log_primary-instance" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds-event-log_primary-instance.png" /></p>
<p>補足として、リードレプリカは再起動のみを実行していることがわかる。</p>
<p><img alt="rds-event-log_read-replica" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds-event-log_read-replica.png" /></p>
<p><br></p>
<h3 id="_23">フェイルオーバー<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h3>
<h4 id="aurora">▼ Auroraのフェイルオーバーとは<a class="headerlink" href="#aurora" title="Permanent link">&para;</a></h4>
<p>プライマリーインスタンスで障害が起こった場合に、リードレプリカをプライマリーインスタンスに自動的に昇格する。</p>
<p>DBクラスター内の全てのDBインスタンスが同じAZに配置されている場合、あらかじめ異なるAZにリードレプリカを新しく作成する必要がある。</p>
<p>また、フェイルオーバー時に、もしDBクラスター内にリードレプリカが存在していない場合、異なるAZに昇格後のプライマリーインスタンスが自動的に作成される。</p>
<p>リードレプリカが存在している場合、これがプライマリーインスタンスに昇格する。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html#Aurora.Managing.FaultTolerance">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html#Aurora.Managing.FaultTolerance</a></li>
</ul>
</blockquote>
<h4 id="_24">▼ フェイルオーバーによるダウンタイムの最小化<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<p>DBインスタンスがマルチAZ構成の場合、以下の手順を使用してダウンタイムを最小化できる。</p>
<dl>
<dt><code>(1)</code></dt>
<dd>
<p>アプリケーションの接続先をプライマリーインスタンスにする。</p>
</dd>
<dt><code>(2)</code></dt>
<dd>
<p>リードレプリカにダウンタイムの発生する変更を適用する。</p>
<p>Auroraではフェールオーバーが自動的に実行される。</p>
</dd>
<dt><code>(3)</code></dt>
<dd>
<p>フェイルオーバー時に約<code>1</code>～<code>2</code>分のダウンタイムが発生する。</p>
<p>フェイルオーバーを使用しない場合、DBインスタンスの再起動でダウンタイムが発生する。</p>
<p>ただし、これよりは時間が短いため、相対的にダウンタイムを短縮できる。</p>
</dd>
</dl>
<blockquote>
<ul>
<li><a href="https://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/">https://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/</a></li>
</ul>
</blockquote>
<h4 id="db_8">▼ DBインスタンスの昇格優先順位<a class="headerlink" href="#db_8" title="Permanent link">&para;</a></h4>
<p>Auroraの場合、フェイルオーバーによって昇格するDBインスタンスは次の順番で決定される。</p>
<p>DBインスタンスごとにフェイルオーバーの優先度 (<code>0</code>～<code>15</code>) を設定でき、優先度の数値の小さいDBインスタンスほど優先され、昇格対象になる。</p>
<p>優先度が同じだと、インスタンスクラスが大きいDBインスタンスが昇格対象になる。</p>
<p>インスタンスクラスが同じだと、同じサブネットにあるDBインスタンスが昇格対象になる。</p>
<dl>
<dt><code>(1)</code></dt>
<dd>
<p>優先度の順番</p>
</dd>
<dt><code>(2)</code></dt>
<dd>
<p>インスタンスクラスの大きさ</p>
</dd>
<dt><code>(3)</code></dt>
<dd>
<p>同じサブネット</p>
</dd>
</dl>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Concepts.AuroraHighAvailability.html</a></li>
</ul>
</blockquote>
<h4 id="_25">▼ ダウンタイムを最小化できない場合<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h4>
<p>エンジンバージョンのアップグレードは両方のDBインスタンスで同時に実行する必要があるため、フェイルオーバーを使用できず、ダウンタイムを最小化できない。</p>
<p><br></p>
<h2 id="02-06">02-06. 負荷対策<a class="headerlink" href="#02-06" title="Permanent link">&para;</a></h2>
<h3 id="_26">エンドポイントの使い分け<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<p>DBインスタンスに応じたエンドポイントが用意されている。</p>
<p>アプリケーションからのCRUDの種類に応じて、アクセス先を振り分けることにより、負荷を分散させられる。</p>
<p>読み出しオンリーエンドポイントに対して、READ以外の処理を行うと、以下の通り、エラーとなる。</p>
<div class="highlight"><pre><span></span><code>/*<span class="w"> </span>SQL<span class="w"> </span>Error<span class="w"> </span><span class="o">(</span><span class="m">1290</span><span class="o">)</span>:<span class="w"> </span>The<span class="w"> </span>MySQL<span class="w"> </span>server<span class="w"> </span>is<span class="w"> </span>running<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>--read-only<span class="w"> </span>option<span class="w"> </span>so<span class="w"> </span>it<span class="w"> </span>cannot<span class="w"> </span>execute<span class="w"> </span>this<span class="w"> </span>statement<span class="w"> </span>*/
</code></pre></div>
<p><br></p>
<h3 id="autoscaling">リードレプリカの手動追加、AutoScaling<a class="headerlink" href="#autoscaling" title="Permanent link">&para;</a></h3>
<p>リードレプリカの手動追加もしくはAutoScalingによって、Auroraに関するメトリクス (例：平均CPU使用率、平均DB接続数、など) がターゲット値を維持できるように、リードレプリカの自動水平スケーリング (リードレプリカ数の増減) を実行する。</p>
<p>注意点として、RDS (非Aurora) スケーリングは、ストレージサイズを増加させる垂直スケーリングであり、Auroraのスケーリングとは仕様が異なっている。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Integrating.AutoScaling.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Aurora.Integrating.AutoScaling.html</a></li>
<li><a href="https://engineers.weddingpark.co.jp/aws-aurora-autoscaling/">https://engineers.weddingpark.co.jp/aws-aurora-autoscaling/</a></li>
<li><a href="https://qiita.com/1_ta/items/3880a8da8a29e4c8d8f0">https://qiita.com/1_ta/items/3880a8da8a29e4c8d8f0</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="_27">クエリキャッシュの利用<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h3>
<p>MySQLやRedisのクエリキャッシュ機能を利用する。</p>
<p>ただし、MySQLのクエリキャッシュ機能は、バージョン<code>8</code>で廃止されることになっている。</p>
<p><br></p>
<h3 id="_28">ユニークキーまたはインデックスの利用<a class="headerlink" href="#_28" title="Permanent link">&para;</a></h3>
<p>スロークエリを検出し、そのSQLで対象としているカラムにユニークキーやインデックスを設定する。</p>
<p>スロークエリを検出する方法として、RDSの<code>long_query_time</code>パラメーターに基づいた検出や、<code>EXPLAIN</code>句による予想実行時間の比較などがある。</p>
<p><br></p>
<h3 id="_29">テーブルを正規化し過ぎない<a class="headerlink" href="#_29" title="Permanent link">&para;</a></h3>
<p>テーブルを正規化すると保守性が高まるが、アプリケーションのSQLで<code>JOIN</code>句が必要になる。</p>
<p>しかし、<code>JOIN</code>句を含むSQLは、含まないSQLと比較して、実行速度が遅くなる。</p>
<p>そこで、戦略的に正規化し過ぎないようにする。</p>
<p><br></p>
<h3 id="_30">インスタンスタイプのスケールアップ<a class="headerlink" href="#_30" title="Permanent link">&para;</a></h3>
<p>インスタンスタイプをスケールアップさせることにより、接続過多のエラー (<code>ERROR 1040 (HY000): Too many connections</code>) に対処する。</p>
<p>補足として現在の最大接続数はパラメーターグループの値から確認できる。</p>
<p>コンソール画面からはおおよその値しかわからないため、SQLで確認した方が良い。</p>
<div class="highlight"><pre><span></span><code><span class="k">SHOW</span><span class="w"> </span><span class="k">GLOBAL</span><span class="w"> </span><span class="n">VARIABLES</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;max_connections&#39;</span><span class="p">;</span>

<span class="o">+</span><span class="c1">-----------------+-------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Variable_name</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Value</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+-------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">max_connections</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">640</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">-----------------+-------+</span>
<span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span>
</code></pre></div>
<p><br></p>
<h2 id="02-07">02-07. イベント<a class="headerlink" href="#02-07" title="Permanent link">&para;</a></h2>
<p>コンソール画面ではイベントが英語で表示されているため、リファレンスも英語でイベントを探した方が良い。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_Events.Messages.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/USER_Events.Messages.html</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="03-rds-aurora">03. RDS (非Aurora)<a class="headerlink" href="#03-rds-aurora" title="Permanent link">&para;</a></h2>
<h3 id="_31">ダウンタイム<a class="headerlink" href="#_31" title="Permanent link">&para;</a></h3>
<h4 id="_32">▼ ダウンタイムの発生条件<a class="headerlink" href="#_32" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>変更する項目</th>
<th>ダウンタイムの有無</th>
<th>補足</th>
</tr>
</thead>
<tbody>
<tr>
<td>インスタンスクラス</td>
<td>あり</td>
<td>・<code>2</code>個のインスタンスで同時にインスタンスクラスを変更すると、次のようなイベントを確認できる。インスタンスが複数回再起動することからわかる通り、長いダウンタイム (約<code>6</code>～<code>8</code>分) が発生する。そのため、フェイルオーバーを利用したダウンタイムの最小化を行う。<br>・<a href="https://dev.classmethod.jp/articles/rds-scaleup-instancetype/">https://dev.classmethod.jp/articles/rds-scaleup-instancetype/</a> <br>・プライマリーインスタンスのイベント<br><img alt="rds_change-instance-class_primary-instance" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds_change-instance-class_primary-instance.png" /><br>・リードレプリカのイベント<br><img alt="rds_change-instance-class_read-replica" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/rds_change-instance-class_read-replica.png" /></td>
</tr>
<tr>
<td>サブネットグループ</td>
<td>あり</td>
<td></td>
</tr>
<tr>
<td>エンジンバージョン</td>
<td>あり</td>
<td><code>20</code>～<code>30</code>秒のダウンタイムが発生する。この時間は、ワークロード、クラスターサイズ、バイナリログデータのサイズ、ゼロダウンタイムパッチ適用の発動可否、によって変動する。<br>・<a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.html">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.html</a> <br>・<a href="https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.Patching.html#AuroraMySQL.Updates.AMVU">https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Updates.Patching.html#AuroraMySQL.Updates.AMVU</a> <br>また、メジャーバージョンのアップグレードには<code>10</code>分のダウンタイムが発生する。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.MySQL.html#USER_UpgradeDBInstance.MySQL.Major.Overview">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.MySQL.html#USER_UpgradeDBInstance.MySQL.Major.Overview</a></td>
</tr>
<tr>
<td>メンテナンスウィンドウ</td>
<td>条件付きでなし</td>
<td>ダウンタイムが発生する操作が保留中になっている状態で、メンテナンス時間を現在が含まれるように変更すると、保留中の操作がすぐに適用される。そのため、ダウンタイムが発生する。</td>
</tr>
<tr>
<td>パフォーマンスインサイト</td>
<td>条件付きでなし</td>
<td>パフォーマンスインサイトの有効化ではダウンタイムが発生しない。ただし、有効化のためにパラメーターグループの<code>performance_schema</code>を有効化する必要がある。パラメーターグループの変更をDBインスタンスに反映させる上で再起動が必要なため、ここでダウンタイムが発生する。</td>
</tr>
<tr>
<td>バックアップウインドウ</td>
<td>条件付きでなし</td>
<td><code>0</code>から<code>0</code>以外の値、<code>0</code>以外の値から<code>0</code>に変更した場合、ダウンタイムが発生する。</td>
</tr>
<tr>
<td>パラメーターグループ</td>
<td>なし</td>
<td>パラメーターグループ自体の変更ではダウンタイムは発生しない。また、静的パラメーターはパラメーターグループの変更に合わせて適用される。ただし、動的パラメーターを変更した場合は、これをDBインスタンスに反映させるために再起動が必要であり、ここでダウンタイムが発生する。<br>- <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_WorkingWithParamGroups.html</a></td>
</tr>
<tr>
<td>セキュリティグループ</td>
<td>なし</td>
<td></td>
</tr>
<tr>
<td>マイナーバージョン自動アップグレード</td>
<td>なし</td>
<td>エンジンバージョンの変更にはダウンタイムが発生するが、自動アップグレードの設定にはダウンタイムが発生しない。</td>
</tr>
<tr>
<td>ストレージのAutoScaling</td>
<td>なし</td>
<td></td>
</tr>
</tbody>
</table>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.Settings</a></li>
</ul>
</blockquote>
<p><br></p>
<h3 id="_33">フェイルオーバー<a class="headerlink" href="#_33" title="Permanent link">&para;</a></h3>
<h4 id="rds_1">▼ RDSのフェイルオーバーとは<a class="headerlink" href="#rds_1" title="Permanent link">&para;</a></h4>
<p>スタンバイレプリカがプライマリーインスタンスに昇格する。</p>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html</a></li>
</ul>
<h4 id="_34">▼ フェイルオーバーによるダウンタイムの最小化<a class="headerlink" href="#_34" title="Permanent link">&para;</a></h4>
<p>DBインスタンスがマルチAZ構成の場合、以下の手順を使用してダウンタイムを最小化できる。</p>
<blockquote>
<ul>
<li><a href="https://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/">https://lab.taf-jp.com/rds%E3%81%AE%E3%83%95%E3%82%A7%E3%82%A4%E3%83%AB%E3%82%AA%E3%83%BC%E3%83%90%E3%83%BC%E6%99%82%E3%81%AE%E6%8C%99%E5%8B%95%E3%82%92%E7%90%86%E8%A7%A3%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B/</a></li>
</ul>
</blockquote>
<dl>
<dt><code>(1)</code></dt>
<dd>
<p>アプリケーションの接続先をプライマリーインスタンスにする。</p>
</dd>
<dt><code>(2)</code></dt>
<dd>
<p>特定の条件下でのみ、フェイルオーバーが自動的に実行される。</p>
</dd>
</dl>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html#Concepts.MultiAZ.Failover">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Concepts.MultiAZ.html#Concepts.MultiAZ.Failover</a></li>
</ul>
</blockquote>
<p>(3) 非AuroraのRDSでは条件に当てはまらない場合、リードレプリカを手動でフェイルオーバーさせる。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.MySQL.html#USER_UpgradeDBInstance.MySQL.ReducedDowntime">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_UpgradeDBInstance.MySQL.html#USER_UpgradeDBInstance.MySQL.ReducedDowntime</a></li>
</ul>
</blockquote>
<p>(4) フェイルオーバー時に約<code>1</code>～<code>2</code>分のダウンタイムが発生する。</p>
<p>フェイルオーバーを使用しない場合、DBインスタンスの再起動でダウンタイムが発生するが、これよりは時間が短いため、相対的にダウンタイムを短縮できる。</p>
<p><br></p>
<h3 id="_35">イベント<a class="headerlink" href="#_35" title="Permanent link">&para;</a></h3>
<p>コンソール画面ではイベントが英語で表示されているため、リファレンスも英語でイベントを探した方が良い。</p>
<blockquote>
<ul>
<li><a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Messages.html">https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.Messages.html</a></li>
</ul>
</blockquote>
<p><br></p>
<h2 id="04-rds">04. RDSプロキシ<a class="headerlink" href="#04-rds" title="Permanent link">&para;</a></h2>
<h3 id="rds_2">RDSプロキシとは<a class="headerlink" href="#rds_2" title="Permanent link">&para;</a></h3>
<p>クラウドDBプロキシとして働く。</p>
<p><br></p>
<h3 id="_36">コネクションプールの管理<a class="headerlink" href="#_36" title="Permanent link">&para;</a></h3>
<p>アプリからRDSにクエリが送信された時、コネクションを新しく作成せずに、コネクションプール内の非アクティブなコネクションを再利用し、RDSに転送する。</p>
<p>アプリからDBのインスタンスに直接的にクエリを送信する場合、アプリはRDSの同時接続の上限数 (インスタンスタイプで決まる) を考慮しない。</p>
<p>そのため、接続数が多くなりやすいアプリ (例：Lambda、マルチスレッド) を使用していると、アプリが無制限にコネクションを新しく作成することになる。</p>
<p>その結果、アプリのコネクションがRDSの同時接続の上限数を超えて接続してしまい、RDSがエラーを返却してしまう。</p>
<p>RDSプロキシは、RDSの同時接続の上限数を考慮しつつ、コネクションプールから非アクティブなコネクションを再利用するため、アプリがRDSの同時接続の上限数を超えて接続することがない。</p>
<p><img alt="aws_rds-proxy" src="https://raw.githubusercontent.com/hiroki-it/tech-notebook-images/master/images/aws_rds-proxy.png" /></p>
<blockquote>
<ul>
<li><a href="https://blog.denet.co.jp/service-relay-2021-0711/">https://blog.denet.co.jp/service-relay-2021-0711/</a></li>
<li><a href="https://blog.sgnet.co.jp/2020/10/java-db.html">https://blog.sgnet.co.jp/2020/10/java-db.html</a></li>
</ul>
</blockquote>
<p><br></p>

  <hr>
<div class="md-source-file">
  <small>
    
      最終更新日:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2023-08-08</span>
      
    
  </small>
</div>


  




                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            ページトップへ戻る
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="https://github.com/hiroki-it" target="_blank" rel="noopener" title="GitHubアカウント" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://twitter.com/Hiroki__IT" target="_blank" rel="noopener" title="Twitterアカウント" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.indexes", "navigation.prune", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f", "clipboard.copy": "\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u30b3\u30d4\u30fc", "search.result.more.one": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3082\u30461\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.more.other": "\u3053\u306e\u30da\u30fc\u30b8\u5185\u306b\u3042\u3068#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.none": "\u4f55\u3082\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f", "search.result.one": "1\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.other": "#\u4ef6\u898b\u3064\u304b\u308a\u307e\u3057\u305f", "search.result.placeholder": "\u691c\u7d22\u30ad\u30fc\u30ef\u30fc\u30c9\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044", "search.result.term.missing": "\u691c\u7d22\u306b\u542b\u307e\u308c\u306a\u3044", "select.version": "\u30d0\u30fc\u30b8\u30e7\u30f3\u5207\u308a\u66ff\u3048"}}</script>
    
    
      <script src="../assets/javascripts/bundle.dff1b7c8.min.js"></script>
      
    
  </body>
</html>